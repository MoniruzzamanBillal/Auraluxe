generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  name      String
  password  String
  role      UserRole @default(user)
  isDeleted Boolean  @default(false)

  cart   Cart?
  orders Order[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model category {
  id        String  @id @default(uuid())
  name      String  @unique
  isDeleted Boolean @default(false)

  products Product[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id   String @id @default(uuid())
  name String @unique

  productCode String?

  brandId    String
  brand      Brand    @relation(fields: [brandId], references: [id])
  categoryId String
  category   category @relation(fields: [categoryId], references: [id])
  quantity   Int

  price Float

  keyFeatures      String
  specifications   String
  productDes       String
  shippingDelivery String?

  productImage String

  cartItems  CartItem[]
  orderItems OrderItem[]

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([categoryId])
}

model Cart {
  id     String @id @default(uuid())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id])

  items CartItem[]

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model CartItem {
  id String @id @default(uuid())

  cartId String
  cart   Cart   @relation(fields: [cartId], references: [id], onDelete: Cascade)

  productId String
  product   Product @relation(fields: [productId], references: [id])

  quantity  Int   @default(1)
  unitPrice Float

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([cartId, productId])
}

// ! order related models 
model OrderItem {
  id String @id @default(uuid())

  orderId String
  order   Order  @relation(fields: [orderId], references: [id], onDelete: Cascade)

  productId String
  product   Product @relation(fields: [productId], references: [id])

  quantity  Int
  unitPrice Float

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Order {
  id     String @id @default(uuid())
  userId String
  user   User   @relation(fields: [userId], references: [id])

  status      ORDERSTATUS @default(PENDING)
  totalAmount Float

  items   OrderItem[]
  payment Payment?


    // Add shipping information fields
  shippingFullName    String
  shippingPhone       String
  shippingAddress     String
  shippingCity        String
  shippingPostalCode  String

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([userId])
}

model Payment {
  id String @id @default(uuid())

  userId  String
  orderId String @unique
  order   Order  @relation(fields: [orderId], references: [id], onDelete: Cascade)

  amount        Float
  transactionId String        @unique
  status        PAYMENTSTATUS @default(PENDING)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  isDeleted Boolean @default(false)

  @@index([transactionId])
  @@index([orderId])
}

model brandType {
  id          String  @id @default(uuid())
  name        String  @unique
  description String
  isDeleted   Boolean @default(false)

  brands Brand[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Brand {
  id          String    @id @default(uuid())
  name        String    @unique
  logo        String
  brandTypeId String
  brandType   brandType @relation(fields: [brandTypeId], references: [id])

  products Product[]

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model projectType {
  id          String  @id @default(uuid())
  name        String  @unique
  description String
  isDeleted   Boolean @default(false)

  projects Project[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model material {
  id          String  @id @default(uuid())
  name        String  @unique
  description String
  isDeleted   Boolean @default(false)

  projects Project[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Project {
  id            String  @id @default(uuid())
  projectName   String  @unique
  projectImg    String
  location      String
  client        String
  architects    String
  website       String
  facebookLink  String?
  instagramLink String?
  linkedinLink  String?
  xLink         String?
  description   String?

  projectTypeId String
  projectType   projectType @relation(fields: [projectTypeId], references: [id])

  materialId String
  material   material @relation(fields: [materialId], references: [id])

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model keyBrands {
  id          String @id @default(uuid())
  name        String @unique
  logo        String
  description String

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model homeBanner {
  id          String @id @default(uuid())
  title       String @unique
  imageUrl    String
  description String

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("home_banner")
}

model homeOurFeatured {
  id          String @id @default(uuid())
  title       String @unique
  imageUrl    String
  description String

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("home_our_featured")
}

model homeOurProduct {
  id          String @id @default(uuid())
  title       String @unique
  imageUrl    String
  description String

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("home_our_product")
}

model ourFeaturedProduct {
  id       String @id @default(uuid())
  imageUrl String

  isDeleted Boolean @default(false)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("our_featured_product")
}

enum UserRole {
  user
  admin
}

enum ORDERSTATUS {
  PENDING
  PAID
  CANCELED
}

enum PAYMENTSTATUS {
  PENDING
  COMPLETED
  FAILED
  CANCELED
}
